<!DOCTYPE html>
<!--<html lang="en">-->
<html lang="it">
<head>
	<!--<meta charset="utf-8">-->
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<meta name="description" content="Esercitazione di Elementi di Informatica Grafica - Dipartimento d'Ingegneria - Universit&agrave; degli Studi di Perugia">
	<meta name="author" content="Luca Grilli">
	
	<title>Esercitazione di Elementi di Informatica Grafica</title>
	<style>
		#preview-box {
			background-color: rgba(1,1,1,0.1);
			padding: 1px 10px;
			border-radius: 10px;
		}
	</style>
	<link id="linkstyle" rel="stylesheet" href="css/markdown.css">
</head>

<body>

<!-- [start] SELETTORE STILE
================================================== -->
<strong>Scegli un altro foglio di stile</strong>
<div id="preview-box">
		<select style="width:100%" id="themes">
			<option value="css/markdown.css">markdown</option>
			<option value="css/markdown-alt.css">markdown-alt</option>
			<option value="css/markdown-luca.css">markdown-luca</option>
			<option value="css/markdown1.css">markdown1</option>
			<option value="css/markdown2.css">markdown2</option>
			<option value="css/markdown3.css">markdown3</option>
			<option value="css/markdown4.css">markdown4</option>
			<option value="css/markdown5.css">markdown5</option>
			<option value="css/markdown6.css">markdown6</option>
			<option value="css/markdown7.css">markdown7</option>
			<option value="css/markdown8.css">markdown8</option>
			<option value="css/markdown9.css">markdown9</option>
			<option value="css/markdown10.css">markdown10</option>
			<option value="css/avenir-white.css">avenir-white</option>
			<option value="css/foghorn.css">foghorn</option>
			<option value="css/screen.css">screen</option>
			<option value="css/swiss.css">swiss</option>
			<option value="css/pandoc-default.css">pandoc-default</option>
			<option value="css/pandoc-bigger-font-code.css">pandoc-bigger-font-code</option>
			<option value="css/splendor.css">splendor</option>
		</select>
</div>
<script>
	var linkstyle = document.getElementById('linkstyle');
	var themes = document.getElementById('themes');
	themes.onchange = function(e) {
		linkstyle.href = themes.value;
	};
</script>
<!-- [end] SELETTORE STILE
================================================== -->

<!-- [start] PANDOC OUTPUT
================================================== -->


<h1 id="gestione-delle-eccezioni">Gestione delle Eccezioni</h1>
<h3 id="concetti-preliminari">Concetti preliminari</h3>
<p>Un aspetto molto complesso delle programmazione &egrave; la <strong>gestione egli errori</strong> che si verificano a run-time. L'evoluzione di un programma quasi mai risulta essere completamente prevedibile, spesso dipende da valori di input immessi dall'utente o dal comportamento di altre entit&agrave; di cui si ha un limitato controllo. Pertanto, nella gestione di sistemi software complessi, &egrave; necessario stabilire come deve comportarsi il sistema quando alcune operazioni non vengono eseguite con successo o vengono eseguite in modo anomalo; ad esempio un programma che necessita di accedere alla rete Internet, potrebbe fallire perch&eacute; manca la connettivit&agrave;. Non si tratta quindi di una mera questione estetica, poich&eacute; la non gestione degli errori o una gestione errata degli stessi pu&ograve; rendere il comportamento del programma imprevedibile o addirittura arrestarlo bruscamente: il cosiddetto &quot;crash&quot; ne &egrave; un'esemplare dimostrazione.</p>
<p>Per iniziare si consideri la classe <strong><code>IntegerMatrix</code></strong>.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">public</span> <span class="kw">class</span> IntegerMatrix {

    <span class="kw">private</span> <span class="dt">int</span>[][] matrix;

    <span class="kw">public</span> <span class="fu">IntegerMatrix</span>(<span class="dt">int</span> rows, <span class="dt">int</span> columns) {
        <span class="kw">this</span>.<span class="fu">matrix</span> = <span class="kw">new</span> <span class="dt">int</span>[rows][columns];
    }

    <span class="kw">public</span> <span class="dt">void</span> <span class="fu">setValue</span>(<span class="dt">int</span> i, <span class="dt">int</span> j, <span class="dt">int</span> value) {
        <span class="kw">this</span>.<span class="fu">matrix</span>[i][j] = value;
    }

    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getValue</span>(<span class="dt">int</span> i, <span class="dt">int</span> j) {
        <span class="kw">return</span> <span class="kw">this</span>.<span class="fu">matrix</span>[i][j];
    }

    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getMaxOfRow</span>(<span class="dt">int</span> i) {
        <span class="dt">int</span> max = <span class="kw">this</span>.<span class="fu">matrix</span>[i][<span class="dv">0</span>];
        <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">1</span>; j &lt; <span class="kw">this</span>.<span class="fu">matrix</span>[i].<span class="fu">length</span>; j++)
            <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">matrix</span>[i][j] &gt; max)
                max = <span class="kw">this</span>.<span class="fu">matrix</span>[i][j];
        <span class="kw">return</span> max;
    }

    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getMaxOfColumn</span>(<span class="dt">int</span> j) {
        <span class="dt">int</span> max = <span class="kw">this</span>.<span class="fu">matrix</span>[<span class="dv">0</span>][j];
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">1</span>; i &lt; <span class="kw">this</span>.<span class="fu">matrix</span>.<span class="fu">length</span>; i++)
            <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">matrix</span>[i][j] &gt; max)
                max = <span class="kw">this</span>.<span class="fu">matrix</span>[i][j];
        <span class="kw">return</span> max;
    }

    <span class="kw">public</span> <span class="dt">int</span> <span class="fu">getMax</span>() {
        <span class="dt">int</span> max = <span class="kw">this</span>.<span class="fu">matrix</span>[<span class="dv">0</span>][<span class="dv">0</span>];
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; <span class="kw">this</span>.<span class="fu">matrix</span>.<span class="fu">length</span>; i++)
            <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; <span class="kw">this</span>.<span class="fu">matrix</span>[i].<span class="fu">length</span>; j++)
                <span class="kw">if</span> (<span class="kw">this</span>.<span class="fu">matrix</span>[i][j] &gt; max)
                    max = <span class="kw">this</span>.<span class="fu">matrix</span>[i][j];
        <span class="kw">return</span> max;
    }

} <span class="co">// end class</span></code></pre></div>
<p>Si consideri inoltre il codice della classe di test <strong><code>TestMatrix</code></strong>, che sfrutta la classe <strong><code>InputWindow</code></strong> per chiedere all'utente di inserire le dimensioni e il contenuto della matrice.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import javax.swing.JOptionPane;</span>

<span class="kw">public</span> <span class="kw">class</span> TestMatrix {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {

        InputWindow in = <span class="kw">new</span> <span class="fu">InputWindow</span>();
        <span class="dt">int</span> rows = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire il numero di righe&quot;</span>);
        <span class="dt">int</span> columns = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire il numero di colonne&quot;</span>);

        IntegerMatrix matrix = <span class="kw">new</span> <span class="fu">IntegerMatrix</span>(rows, columns);

        <span class="dt">int</span> ijVal = -<span class="dv">1</span>;
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; rows; i++)
            <span class="kw">for</span> (<span class="dt">int</span> j = <span class="dv">0</span>; j &lt; columns; j++) {
                ijVal = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire il valore di matrix[&quot;</span> + i + <span class="st">&quot;][&quot;</span> + j + <span class="st">&quot;]&quot;</span>);
                matrix.<span class="fu">setValue</span>(i, j, ijVal);
            }

        <span class="dt">boolean</span> quit = <span class="kw">false</span>;
        String str = <span class="kw">null</span>;
        <span class="dt">int</span> i = -<span class="dv">1</span>;
        <span class="dt">int</span> j = -<span class="dv">1</span>;
        <span class="kw">while</span> (!quit) {
            <span class="dt">int</span> confirm = JOptionPane.<span class="fu">showConfirmDialog</span>(<span class="kw">null</span>, <span class="st">&quot;Desideri proseguire?&quot;</span>, <span class="st">&quot;Visualizzazione interattiva&quot;</span>, JOptionPane.<span class="fu">YES_NO_OPTION</span>);
            <span class="kw">if</span> (confirm == JOptionPane.<span class="fu">NO_OPTION</span>)
                quit = <span class="kw">true</span>;
            <span class="kw">else</span> {
                i = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire indice di riga i&quot;</span>);
                j = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire indice di colonna j&quot;</span>);
                System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;matrix[&quot;</span> + i + <span class="st">&quot;][&quot;</span> + j + <span class="st">&quot;] = &quot;</span> + matrix.<span class="fu">getValue</span>(i, j));
            }
        }
    }
} <span class="co">// end class</span></code></pre></div>
<p>Innanzi tutto si osservi la presenza del componente <code>javax.swing.</code><strong><code>JOptionPane</code></strong> (<a href="http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html">[tutorial]</a> | <a href="https://docs.oracle.com/javase/8/docs/api/index.html?javax/swing/JOptionPane.html">[api]</a>).</p>
<p><strong>Domanda 1</strong>: a cosa serve tale componente del pacchetto <code>javax.swing</code>?</p>
<p><strong>Domanda 2</strong>: cosa succede se, in fase di esecuzione, l'utente inserisce un indice di riga e/o di colonna non corretti?</p>
<p><strong>Domanda 3</strong>: il tipo di errore rilevato dalla JVM pu&ograve; essere individuato in fase di compilazione inserendo un opportuno blocco di codice preposto a tale scopo?</p>
<p><strong>Domanda 4</strong>: cosa si pu&ograve; fare invece in fase di esecuzione?</p>
<p>Java permette di gestire gli errori a run-time mediante il meccanismo delle eccezioni. Un'eccezione Java &egrave; un oggetto di tipo (eredita direttamente o indirettamente) <strong><code>Exception</code></strong>. Ogni qual volta si verifica un errore a run-time viene automaticamente creato un oggetto di tipo <strong><code>Exception</code></strong> che altera il normale flusso di esecuzione del programma, per brevit&agrave; si dice che viene sollevata un'eccezione. In particolare, non appena la JVM si accorge che &egrave; stata sollevata un'eccezione interrompe il normale flusso di esecuzione e ricerca eventuali porzioni di codice preposte alla gestione di quella eccezione. Se non &egrave; stata prevista alcuna forma di gestione dell'eccezione viene interrotta l'esecuzione del programma! Si osservi pertanto che un'adeguata gestione delle eccezioni permette di circoscrivere gli effetti dannosi di un errore ed evitare pertanto il crash.</p>
<p>La sintassi pi&ugrave; comune per la gestione di un'eccezione &egrave; la seguente:</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">    <span class="kw">try</span> {
        <span class="co">// ...</span>
        <span class="co">// ...</span>
        <span class="co">// istruzioni che possono sollevare un&#39;eccezione</span>
        <span class="co">// ...</span>
        <span class="co">// ...</span>
    }
    <span class="kw">catch</span>(TipoEccezione te) {
        <span class="co">// ...</span>
        <span class="co">// codice per la gestione dell&#39;eccezione</span>
        <span class="co">// ...</span>
    }</code></pre></div>
<p>Qualora si verifichi l'eccezione in questione la JVM interrompe il normale flusso di esecuzione del programma ed esegue le istruzioni del corrispondente blocco <code>catch</code>.</p>
<p><strong>Domanda 5</strong>: dopo l'ultima istruzione del blocco <code>catch</code> quale sar&agrave; la prossima istruzione eseguita dalla JVM?</p>
<p><strong>Domanda 6</strong>: se all'interno del blocco <code>try</code> viene sollevata un'eccezione di un tipo che estende <strong><code>TipoEccezione</code></strong>, tale eccezione sar&agrave; catturata dal blocco <code>catch</code>?</p>
<p><strong>Domanda 7</strong>: se invece si tratta di un'eccezione che &egrave; un super-tipo di <strong><code>TipoEccezione</code></strong>?</p>
<p><strong>Domanda 8</strong>: e se l'eccezione sollevata non &egrave; n&eacute; un sotto-tipo n&eacute; un super tipo di <strong><code>TipoEccezione</code></strong>?</p>
<p><strong>Domanda 9</strong>: in base a quanto detto provare a gestire eccezioni di tipo <strong><code>ArrayIndexOutOfBoundsException</code></strong> nel precedente programma.</p>
<p><strong>Domanda 10</strong>: dove conviene gestire l'eccezione nella classe <strong><code>IntegerMatrix</code></strong> o nella classe <strong><code>TestMatrix</code></strong>?</p>
<p>Segue una possibile implementazione della classe TestMatrix in cui l'eccezione di cui sopra viene catturata in un blocco <code>catch</code> che si limita a stampare sullo standard output un semplice messaggio di notifica. Si osservi che cos&igrave; operando si evita il crash del programma.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import javax.swing.JOptionPane;</span>

<span class="kw">public</span> <span class="kw">class</span> TestMatrix {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {

        <span class="co">// ...</span>
        <span class="co">// ...</span>

        <span class="dt">boolean</span> quit = <span class="kw">false</span>;
        String str = <span class="kw">null</span>;
        <span class="dt">int</span> i = -<span class="dv">1</span>;
        <span class="dt">int</span> j = -<span class="dv">1</span>;
        <span class="kw">while</span> (!quit) {
            <span class="dt">int</span> confirm = JOptionPane.<span class="fu">showConfirmDialog</span>(<span class="kw">null</span>, <span class="st">&quot;Desideri proseguire?&quot;</span>, <span class="st">&quot;Visualizzazione interattiva&quot;</span>, JOptionPane.<span class="fu">YES_NO_OPTION</span>);
            <span class="kw">if</span> (confirm == JOptionPane.<span class="fu">NO_OPTION</span>)
                quit = <span class="kw">true</span>;
            <span class="kw">else</span> {
                i = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire indice di riga i&quot;</span>);
                j = in.<span class="fu">readInt</span>(<span class="st">&quot;Inserire indice di colonna j&quot;</span>);
                <span class="kw">try</span> {
                    System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;matrix[&quot;</span> + i + <span class="st">&quot;][&quot;</span> + j + <span class="st">&quot;] = &quot;</span> + matrix.<span class="fu">getValue</span>(i, j));
                }
                <span class="kw">catch</span>(ArrayIndexOutOfBoundsException aioobe) {
                    System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Eccezione catturata!&quot;</span>);
                }
            }
        }
    }
} <span class="co">// end class</span></code></pre></div>
<p>Facendo riferimento alla documentazione Java (<a href="http://docs.oracle.com/javase/tutorial/uiswing/components/dialog.html">[tutorial]</a> | <a href="https://docs.oracle.com/javase/8/docs/api/index.html?javax/swing/JOptionPane.html">[api]</a>), trovare il componente swing pi&ugrave; adatto a notificare il messaggio di errore all'utente. Segue sotto una possibile soluzione.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">    <span class="co">// ...</span>
    
    <span class="kw">try</span> {
        System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;matrix[&quot;</span> + i + <span class="st">&quot;][&quot;</span> + j + <span class="st">&quot;] = &quot;</span> + matrix.<span class="fu">getValue</span>(i, j));
    }
    <span class="kw">catch</span>(ArrayIndexOutOfBoundsException aioobe) {
        <span class="co">//custom title, error icon</span>
        JOptionPane.<span class="fu">showMessageDialog</span>(<span class="kw">null</span>,
            <span class="st">&quot;La riga i o la colonna j specificati sono errati.&quot;</span>,
            <span class="st">&quot;Errore di inserimento&quot;</span>,
            JOptionPane.<span class="fu">ERROR_MESSAGE</span>);
    }
    
    <span class="co">// ...</span></code></pre></div>
<p><strong>Domanda 11</strong>: individuare il componente swing pi&ugrave; adatto per mostrare all'utente il valore di <code>mat[i][j]</code> e utilizzarlo al posto dell'istruzione: <code>System.out.println(&quot;matrix[&quot; + i + &quot;][&quot; + j + &quot;] = &quot; + matrix.getValue(i, j));</code>.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">    <span class="co">// ...</span>
    
    <span class="kw">try</span> {
        JOptionPane.<span class="fu">showMessageDialog</span>(<span class="kw">null</span>,
                                    <span class="st">&quot;matrix[&quot;</span> + i + <span class="st">&quot;][&quot;</span> + j + <span class="st">&quot;] = &quot;</span> + matrix.<span class="fu">getValue</span>(i, j),
                                    <span class="st">&quot;IntegerMatrix info&quot;</span>,
                                    JOptionPane.<span class="fu">INFORMATION_MESSAGE</span>);
    }
    <span class="kw">catch</span>(ArrayIndexOutOfBoundsException aioobe) {
        <span class="co">//custom title, error icon</span>
        JOptionPane.<span class="fu">showMessageDialog</span>(<span class="kw">null</span>,
                                    <span class="st">&quot;La riga i o la colonna j specificati sono errati.&quot;</span>,
                                    <span class="st">&quot;Errore di inserimento&quot;</span>,
                                    JOptionPane.<span class="fu">ERROR_MESSAGE</span>);
    }
    
    <span class="co">// ...</span></code></pre></div>
<p><strong>Domanda 12</strong>: modificare il codice in modo tale che non sia pi&ugrave; necessario utilizzare la classe <strong><code>InputWindow</code></strong>.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import javax.swing.JOptionPane;</span>

<span class="kw">public</span> <span class="kw">class</span> TestMatrix {

    <span class="kw">private</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">insertIntegerDialog</span>(String message) {
        <span class="dt">int</span> value = Integer.<span class="fu">MAX_VALUE</span>;
        Object[] options = {<span class="st">&quot;OK&quot;</span>, <span class="st">&quot;Annulla&quot;</span>};
        String s = (String)JOptionPane.<span class="fu">showInputDialog</span>(
                                                    <span class="kw">null</span>,
                                                    (Object)message,
                                                    <span class="st">&quot;Input&quot;</span>,
                                                    JOptionPane.<span class="fu">QUESTION_MESSAGE</span>,
                                                    <span class="kw">null</span>,
                                                    <span class="kw">null</span>,<span class="co">//options</span>
                                                    (Object)<span class="st">&quot;0&quot;</span>);
        <span class="kw">try</span> {
            value = Integer.<span class="fu">valueOf</span>(s);
        }
        <span class="kw">catch</span>(NumberFormatException nfe) {
            JOptionPane.<span class="fu">showMessageDialog</span>(
                                        <span class="kw">null</span>,
                                        <span class="st">&quot;Soltanto valori interi possono essere inseriti.&quot;</span>,
                                        <span class="st">&quot;Input Error&quot;</span>,
                                        JOptionPane.<span class="fu">ERROR_MESSAGE</span>);
        }
        <span class="kw">return</span> value;
    } <span class="co">// end method readInt(String message)</span>

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">int</span> <span class="fu">readInt</span>(String message) {
        <span class="dt">int</span> value = Integer.<span class="fu">MAX_VALUE</span>;
        <span class="dt">boolean</span> rightInsert = <span class="kw">false</span>;
        <span class="kw">while</span> (!rightInsert) {
            value = <span class="fu">insertIntegerDialog</span>(message);
            <span class="kw">if</span> (value != Integer.<span class="fu">MAX_VALUE</span>)
                rightInsert = <span class="kw">true</span>;
        }
        <span class="kw">return</span> value;
    }

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {

        <span class="dt">int</span> rows = <span class="fu">readInt</span>(<span class="st">&quot;Inserire il numero di righe&quot;</span>);
        <span class="dt">int</span> columns = <span class="fu">readInt</span>(<span class="st">&quot;Inserire il numero di colonne&quot;</span>);

        IntegerMatrix matrix = <span class="kw">new</span> <span class="fu">IntegerMatrix</span>(rows, columns);

        <span class="co">//...</span>
        <span class="co">//...</span>
    }

} <span class="co">// end class</span></code></pre></div>
<h3 id="gestione-obbligata-di-eccezioni">Gestione obbligata di eccezioni</h3>
<p>Si osservi che la scelta di gestire o meno un'eccezione di tipo <strong><code>ArrayIndexOutOfBoundsException</code></strong> spetta completamente al programmatore. Tuttavia, non sempre le cose stanno in questi termini; esistono alcuni tipi di eccezioni che devono essere obbligatoriamente gestite o in modo diretto o in modo indiretto. In particolare, se un'eccezione estende <strong><code>RuntimeException</code></strong>, che a sua volta estende <strong><code>Exception</code></strong>, NON deve essere obbligatoriamente gestita. Se, invece, NON estende <strong><code>RuntimeException</code></strong> deve essere obbligatoriamente gestita, altrimenti viene segnalato un errore in fase di compilazione.</p>
<p>La gestione (obbligata) delle eccezioni &egrave; molto comune quando si utilizzano le istruzioni per la gestione dell'Input/Output di Java. Ad esempio, le istruzioni per la lettura/scrittura di file o per la lettura dell'input d'utente da console (tastiera) possono spesso sollevare delle eccezioni da gestire in modo obbligatorio. Infatti, molte situazioni &quot;eccezionali/anomale&quot; possono verificarsi: il file non esiste, non si hanno i diritti di accesso al file, il formato del file non &egrave; conforme a quello specificato, ecc..</p>
<p>Si consideri ad esempio il seguente programma che tenta di leggere l'input dell'utente da console utilizzando la variabile <code>System.in</code>. <code>System.in</code> referenzia l'oggetto che permette di interagire con la tastiera.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java"><span class="kw">import java.io.BufferedReader;</span>
<span class="kw">import java.io.InputStreamReader;</span>
<span class="kw">import java.io.IOException;</span>

<span class="kw">public</span> <span class="kw">class</span> TestInputFromConsole {

    <span class="kw">public</span> <span class="dt">static</span> <span class="dt">void</span> <span class="fu">main</span>(String[] args) {

        <span class="dt">int</span> dim = Integer.<span class="fu">valueOf</span>(args[<span class="dv">0</span>]);
        String[] strArray = <span class="kw">new</span> String[dim];

        BufferedReader buffRead = <span class="kw">new</span> BufferedReader(<span class="kw">new</span> InputStreamReader(System.<span class="fu">in</span>));

        <span class="dt">int</span> index = -<span class="dv">1</span>;
        String str = <span class="kw">null</span>;
        <span class="dt">boolean</span> end = <span class="kw">false</span>;
        <span class="kw">while</span> (!end) {
            System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Inserisci un indice i oppure q per terminare.&quot;</span>);
            str = buffRead.<span class="fu">readLine</span>();
            <span class="kw">if</span> (str.<span class="fu">toLowerCase</span>().<span class="fu">trim</span>().<span class="fu">equals</span>(<span class="st">&quot;q&quot;</span>)) {
                end = <span class="kw">true</span>;
                buffRead.<span class="fu">close</span>();
                <span class="kw">break</span>;
            }
            index = Integer.<span class="fu">valueOf</span>(str);
            System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Inserisci una parola per strArray[&quot;</span> + index + <span class="st">&quot;].&quot;</span>);
            str = buffRead.<span class="fu">readLine</span>();
            strArray[index] = str;
        } <span class="co">// end while</span>

        System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Valori inseriti:&quot;</span>);
        <span class="kw">for</span> (<span class="dt">int</span> i = <span class="dv">0</span>; i &lt; strArray.<span class="fu">length</span>; i++)
            System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;strArray[&quot;</span> + i + <span class="st">&quot;] = &quot;</span> + strArray[i]);

    } <span class="co">// end method main()</span>

} <span class="co">// end class</span></code></pre></div>
<p><strong>Domanda 13</strong>: &egrave; possibile effettuare con successo la compilazione? Che tipo di errore viene segnalato?</p>
<p><strong>Domanda 14</strong>: il compilatore chiede di gestire tutte le eccezioni che le istruzioni di <strong><code>TestInputFromConsole</code></strong> possono sollevare? In caso negativo, quali altre eccezioni possono essere sollevate?</p>
<p><strong>Domanda 15</strong>: modificare il codice in modo tale che vengano gestite tutte le eccezioni sollevabili dal programma, evitando, in caso di errato inserimento, l'uscita dal ciclo <code>for</code>.</p>
<p>Di seguito viene mostrata una possibile implementazione di <strong><code>TestInputFromConsole</code></strong> in cui tutte le eccezioni di cui sopra vengono gestite in modo diretto.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">        <span class="co">// ...</span>

        <span class="kw">while</span> (!end) {
            <span class="kw">try</span> {
                System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Inserisci un indice i oppure q per terminare.&quot;</span>);
                str = buffRead.<span class="fu">readLine</span>();
                <span class="kw">if</span> (str.<span class="fu">toLowerCase</span>().<span class="fu">trim</span>().<span class="fu">equals</span>(<span class="st">&quot;q&quot;</span>)) {
                    end = <span class="kw">true</span>;
                    buffRead.<span class="fu">close</span>();
                    <span class="kw">break</span>;
                }
                index = Integer.<span class="fu">valueOf</span>(str);
                System.<span class="fu">out</span>.<span class="fu">println</span>(<span class="st">&quot;Inserisci una parola per strArray[&quot;</span> + index + <span class="st">&quot;].&quot;</span>);
                str = buffRead.<span class="fu">readLine</span>();
                strArray[index] = str;
            }
            <span class="kw">catch</span>(IOException ioe) {
                ioe.<span class="fu">printStackTrace</span>();
            }
            <span class="kw">catch</span>(ArrayIndexOutOfBoundsException aioobe) {
                aioobe.<span class="fu">printStackTrace</span>();
            }
            <span class="kw">catch</span>(NumberFormatException nfe) {
                nfe.<span class="fu">printStackTrace</span>();
            }
        } <span class="co">// end while</span>

        <span class="co">// ...</span></code></pre></div>
<p><strong>Domanda 16</strong>: l'ordine dei blocchi <code>catch</code>, cio&egrave; del tipo di eccezioni riportate nella clausula <code>catch</code> &egrave; importante o pu&ograve; essere qualsiasi? <strong>Suggerimento</strong>: provare ad inserire prima di tutti i blocchi <code>catch</code>, un nuovo blocco <code>catch</code> per catturare eccezioni generiche di tipo <strong><code>Exception</code></strong>.</p>
<p>L'ordine di apparizione dei vari blocchi <code>catch</code> &egrave; importante, poich&eacute; la JVM ricerca la corrispondenza tra il tipo di oggetto eccezione sollevato e il tipo della clausula <code>catch</code> destinata a gestirlo seguendo l'<strong>ordine sequenziale</strong> dei blocchi <code>catch</code>. La gestione dell'eccezione viene effettuata dal primo blocco <code>catch</code> che soddisfa il requisito di corrispondenza: stesso tipo o super-tipo. Ne consegue che prima vanno inseriti i sotto-tipo e poi i super-tipi altrimenti il codice di alcuni blocchi <code>catch</code> <strong>non sar&agrave; raggiungibile</strong>; tale situazione essendo individuabile in fase di compilazione viene ivi segnalata.</p>
<p>Si &egrave; detto che la cattura di un'eccezione implica una modifica del normale flusso di esecuzione del programma. Ci&ograve; pu&ograve; comportare che alcune istruzioni necessarie a mantenere la coerenza di talune strutture dati, oppure che rilasciano delle risorse non pi&ugrave; utilizzate, non siano mai eseguite. Per tale ragione &egrave; molto comodo poter disporre di un costrutto che assicuri l'esecuzione di uno specifico insieme di istruzioni sia nel caso in cui delle eccezioni vengano sollevate sia nel caso di normale funzionamento. A tale scopo &egrave; preposta la clausula opzionale <code>finally</code> posta dopo l'ultima blocco <code>catch</code>.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">    <span class="kw">try</span> {
        <span class="co">// ...</span>
        <span class="co">// istruzioni che possono sollevare eccezioni</span>
        <span class="co">// ...</span>
    }
    <span class="kw">catch</span>(TipoEccezione1 te1) {
        <span class="co">// codice per la gestione dell&#39;eccezione</span>
    }
    <span class="kw">catch</span>(TipoEccezione2 te2) {
        <span class="co">// codice per la gestione dell&#39;eccezione</span>
    }
    <span class="kw">catch</span>(TipoEccezione3 te3) {
        <span class="co">// codice per la gestione dell&#39;eccezione</span>
    }
    <span class="kw">finally</span> {
        <span class="co">// codice che viene sempre eseguito</span>
    }</code></pre></div>
<p><strong>Domanda 17</strong>: con riferimento al precedente programma, volendo inserire un blocco <code>catch(Exception e)</code> come si deve procedere?</p>
<p><strong>Domanda 18</strong>: pu&ograve; aver senso sostituire i vari blocchi <code>catch</code> con un unico blocco <code>catch(Exception e)</code>?</p>
<h3 id="demandare-la-gestione-delle-eccezioni">Demandare la gestione delle eccezioni</h3>
<p>Si consideri un metodo <code>method()</code> contenente istruzioni che possono sollevare delle eccezioni che non ereditano da <strong><code>RuntimeException</code></strong>, cio&egrave; eccezioni che devono essere obbligatoriamente gestite, pena la mancata compilazione del codice. In talune situazioni pu&ograve; succedere che, da un punto di vista logico, non deve o non pu&ograve; essere <code>method()</code> a stabilire come tali eccezioni debbano essere gestite. In altre parole, la situazione &egrave; tale per cui &egrave; l'utilizzatore di <code>method()</code> che deve stabilire cosa fare a seguito del lancio di un'eccezione e non <code>method()</code> stesso. In scenari di questo tipo, si deve optare per una gestione indiretta dell'eccezione, vale a dire il metodo non gestisce al suo interno l'eccezione, ma ne demanda la gestione al metodo chiamante. Questo viene fatto aggiungendo la clausula <code>throws</code> dopo la dichiarazione del metodo seguita da una lista separata da virgole di eccezioni sollevabili all'interno del metodo stesso.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">  <span class="kw">public</span> Type <span class="fu">method</span>() <span class="kw">throws</span> Exception1, Exception2,..., ExceptionN {
    
    <span class="co">//...</span>
    
    <span class="co">//istruzioni che possono sollevare eccezioni</span>
    <span class="co">//riportate dopo la clausula throws</span>
    
    <span class="co">//...</span>
  }</code></pre></div>
<p><strong>Domanda 19</strong>: modificare il programma <strong><code>TestInputFromConsole</code></strong> in modo tale che venga demandata la gestione delle eccezioni sollevabili all'interno del metodo <code>main()</code>.</p>
<h3 id="creare-delle-eccezioni-proprie">Creare delle eccezioni proprie</h3>
<p>Consultando la documentazione Java si pu&ograve; notare la presenza di un considerevole numero di eccezioni. Generalmente, &egrave; sufficiente usare in modo opportuno tali eccezioni nelle applicazioni che si andranno a sviluppare. Tuttavia, &egrave; possibile creare dei nuovo tipi di eccezione estendendo la classe <strong><code>Exception</code></strong>. &Egrave; superfluo osservare che il nome di un'eccezione deve essere il pi&ugrave; possibile esplicativo, cio&egrave; deve comunicare in modo immediato il tipo di situazione di errore che rappresenta; per <strong>convenzione</strong> i nomi vanno scelti in modo tale da terminare con il suffisso &quot;Exception&quot;. Ad esempio, l'eccezione <strong><code>AuthenticationNotSupportedException</code></strong> viene utilizzata nella programazione di dispositivi connessi in rete, per segnalare che un certo tipo di autenticazione non &egrave; supportata, quindi &egrave; necessario cambiare la modalit&agrave; di autenticazione o, in ultimo, chiudere la connessione perch&eacute; non &egrave; possibile garantire la sicurezza richiesta.</p>
<h3 id="sollevare-eccezioni">Sollevare eccezioni</h3>
<p>Quanto visto finora non chiarisce come si deve procedere quando si desidera sollevare un'eccezione a seguito del verificarsi di un dato evento. Ci si &egrave; limitati a spiegare come gestire eccezioni sollevabili da metodi di classi scritte da terze parti; ad esempio il metodo <code>readLine()</code> della classe <strong><code>BufferedReader</code></strong> pu&ograve; sollevare un'eccezione di tipo <strong><code>IOException</code></strong> e quindi si &egrave; illustrato come gestire un tale tipo di eccezione.</p>
<p><strong>Domanda 20</strong>: se si desidera eseguire a run-time un certo tipo di controllo e sollevare un'eccezione se tale controllo ha esito negativo, come si deve procedere? Si possono utilizzare i costrutti visti in precedenza?</p>
<p>I precedenti costrutti non permettono di lanciare delle eccezioni, ma solo di gestirle. Per sollevare un'eccezione &egrave; necessario lanciarla dopo averla istanziata – un'eccezione &egrave; un oggetto – con l'istruzione <code>throw</code>, da non confondere con la clausula <code>throws</code> esaminata in precedenza.</p>
<div class="sourceCode"><pre class="sourceCode java"><code class="sourceCode java">
  <span class="kw">public</span> Type <span class="fu">myMethod</span>() <span class="kw">throws</span> MyException {

    <span class="co">//...</span>

    <span class="kw">if</span> (<span class="fu">checkEvent</span>())
      <span class="kw">throw</span> <span class="kw">new</span> <span class="fu">MyException</span>();

    <span class="co">//...</span>

  }</code></pre></div>

<!-- [end] PANDOC OUTPUT
================================================== -->

</body>
</html>
